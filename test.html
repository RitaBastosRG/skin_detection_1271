<!DOCTYPE html>
<html>
<head>
  <title>Image Upload</title>
</head>
<body>
  <h1>Image Upload</h1>

  <form id="upload-form" enctype="multipart/form-data">
    <input type="file" id="image-input" name="image" accept="image/*" />
    <img id="preview-image" style="max-width: 400px; max-height: 400px;" />
    <button type="button" id="upload-button">Upload</button>
  </form>

  <div id="response-container"></div>

  <script>
    document.getElementById("upload-button").addEventListener("click", function() {
      var formData = new FormData();
      var imageInput = document.getElementById("image-input");
      var file = imageInput.files[0];

      if (file) {
        formData.append("file", file);  // Updated form field name

        // var base_url= "http://localhost:8000/upload-image/";  // Update the URL
        var base_url = "https://skindetection-hsuizqzdtq-ew.a.run.app/upload-image/"
        fetch(base_url, {
          method: "POST",
          body: formData
        })
        .then(response => response.json())
        .then(data => {
          var responseContainer = document.getElementById("response-container");
          responseContainer.innerText = "Uploaded filename: " + data.filename + "\n";
          responseContainer.innerText += "Possibility: " + data.possibility;
        })
        .catch(error => {
          console.error("Error:", error);
        });
      }
    });

    document.getElementById("image-input").addEventListener("change", function() {
      var imageInput = document.getElementById("image-input");
      var file = imageInput.files[0];

      if (file) {
        var reader = new FileReader();

        reader.onload = function(e) {
          var previewImage = document.getElementById("preview-image");
          previewImage.src = e.target.result;
        }

        reader.readAsDataURL(file);
      }
    });
  </script>

</body>
</html>
